import{H as L,h as i,I as R,J as te,B as g,d as N,f as v,T as K,K as Y,w as M,v as j,c as oe,l as ne,C as ae,L as se,M as le,F as ce,m as E}from"./index-ByLDJVGx.js";import{g as re,h as ie,e as z,n as k,t as C,u as F,c as H,j as ue,i as X,w as $,a as x,I as de}from"./index-CPDnKRtS.js";import{T as _,o as ve,g as fe,p as V,u as G,H as ye}from"./index-B_JkghoY.js";function me(e,{args:t=[],done:o,canceled:l,error:a}){if(e){const s=e.apply(null,t);re(s)?s.then(n=>{n?o():l&&l()}).catch(a||ie):s?o():l&&l()}else o()}const he=Symbol();function Ie(e){const t=L();t&&z(t.proxy,e)}let Oe=2e3;const Ce=()=>++Oe,U={show:Boolean,zIndex:k,overlay:C,duration:k,teleport:[String,Object],lockScroll:C,lazyRender:C,beforeClose:Function,overlayStyle:Object,overlayClass:F,transitionAppear:Boolean,closeOnClickOverlay:C},Be=Object.keys(U);function we(e,t){return e>t?"horizontal":t>e?"vertical":""}function Pe(){const e=i(0),t=i(0),o=i(0),l=i(0),a=i(0),s=i(0),n=i(""),r=i(!0),w=()=>n.value==="vertical",O=()=>n.value==="horizontal",u=()=>{o.value=0,l.value=0,a.value=0,s.value=0,n.value="",r.value=!0};return{move:d=>{const f=d.touches[0];o.value=(f.clientX<0?0:f.clientX)-e.value,l.value=f.clientY-t.value,a.value=Math.abs(o.value),s.value=Math.abs(l.value);const I=10;(!n.value||a.value<I&&s.value<I)&&(n.value=we(a.value,s.value)),r.value&&(a.value>_||s.value>_)&&(r.value=!1)},start:d=>{u(),e.value=d.touches[0].clientX,t.value=d.touches[0].clientY},reset:u,startX:e,startY:t,deltaX:o,deltaY:l,offsetX:a,offsetY:s,direction:n,isVertical:w,isHorizontal:O,isTap:r}}let P=0;const p="van-overflow-hidden";function Se(e,t){const o=Pe(),l="01",a="10",s=u=>{o.move(u);const h=o.deltaY.value>0?a:l,S=fe(u.target,e.value),{scrollHeight:d,offsetHeight:f,scrollTop:I}=S;let y="11";I===0?y=f>=d?"00":"01":I+f>=d&&(y="10"),y!=="11"&&o.isVertical()&&!(parseInt(y,2)&parseInt(h,2))&&V(u,!0)},n=()=>{document.addEventListener("touchstart",o.start),document.addEventListener("touchmove",s,{passive:!1}),P||document.body.classList.add(p),P++},r=()=>{P&&(document.removeEventListener("touchstart",o.start),document.removeEventListener("touchmove",s),P--,P||document.body.classList.remove(p))},w=()=>t()&&n(),O=()=>t()&&r();ve(w),R(O),te(O),g(t,u=>{u?n():r()})}function Z(e){const t=i(!1);return g(e,o=>{o&&(t.value=o)},{immediate:!0}),o=>()=>t.value?o():null}const D=()=>{var e;const{scopeId:t}=((e=L())==null?void 0:e.vnode)||{};return t?{[t]:""}:null},[be,ke]=H("overlay"),Te={show:Boolean,zIndex:k,duration:k,className:F,lockScroll:C,lazyRender:C,customStyle:Object,teleport:[String,Object]};var xe=N({name:be,props:Te,setup(e,{slots:t}){const o=i(),l=Z(()=>e.show||!e.lazyRender),a=n=>{e.lockScroll&&V(n,!0)},s=l(()=>{var n;const r=z(ue(e.zIndex),e.customStyle);return X(e.duration)&&(r.animationDuration=`${e.duration}s`),M(v("div",{ref:o,style:r,class:[ke(),e.className]},[(n=t.default)==null?void 0:n.call(t)]),[[j,e.show]])});return G("touchmove",a,{target:o}),()=>{const n=v(K,{name:"van-fade",appear:!0},{default:s});return e.teleport?v(Y,{to:e.teleport},{default:()=>[n]}):n}}});const ge=$(xe),ze=z({},U,{round:Boolean,position:x("center"),closeIcon:x("cross"),closeable:Boolean,transition:String,iconPrefix:String,closeOnPopstate:Boolean,closeIconPosition:x("top-right"),safeAreaInsetTop:Boolean,safeAreaInsetBottom:Boolean}),[Ae,B]=H("popup");var Ee=N({name:Ae,inheritAttrs:!1,props:ze,emits:["open","close","opened","closed","keydown","update:show","clickOverlay","clickCloseIcon"],setup(e,{emit:t,attrs:o,slots:l}){let a,s;const n=i(),r=i(),w=Z(()=>e.show||!e.lazyRender),O=oe(()=>{const c={zIndex:n.value};if(X(e.duration)){const m=e.position==="center"?"animationDuration":"transitionDuration";c[m]=`${e.duration}s`}return c}),u=()=>{a||(a=!0,n.value=e.zIndex!==void 0?+e.zIndex:Ce(),t("open"))},h=()=>{a&&me(e.beforeClose,{done(){a=!1,t("close"),t("update:show",!1)}})},S=c=>{t("clickOverlay",c),e.closeOnClickOverlay&&h()},d=()=>{if(e.overlay)return v(ge,E({show:e.show,class:e.overlayClass,zIndex:n.value,duration:e.duration,customStyle:e.overlayStyle,role:e.closeOnClickOverlay?"button":void 0,tabindex:e.closeOnClickOverlay?0:void 0},D(),{onClick:S}),{default:l["overlay-content"]})},f=c=>{t("clickCloseIcon",c),h()},I=()=>{if(e.closeable)return v(de,{role:"button",tabindex:0,name:e.closeIcon,class:[B("close-icon",e.closeIconPosition),ye],classPrefix:e.iconPrefix,onClick:f},null)};let y;const J=()=>{y&&clearTimeout(y),y=setTimeout(()=>{t("opened")})},W=()=>t("closed"),q=c=>t("keydown",c),Q=w(()=>{var c;const{round:m,position:b,safeAreaInsetTop:T,safeAreaInsetBottom:ee}=e;return M(v("div",E({ref:r,style:O.value,role:"dialog",tabindex:0,class:[B({round:m,[b]:b}),{"van-safe-area-top":T,"van-safe-area-bottom":ee}],onKeydown:q},o,D()),[(c=l.default)==null?void 0:c.call(l),I()]),[[j,e.show]])}),A=()=>{const{position:c,transition:m,transitionAppear:b}=e,T=c==="center"?"van-fade":`van-popup-slide-${c}`;return v(K,{name:m||T,appear:b,onAfterEnter:J,onAfterLeave:W},{default:Q})};return g(()=>e.show,c=>{c&&!a&&(u(),o.tabindex===0&&ne(()=>{var m;(m=r.value)==null||m.focus()})),!c&&a&&(a=!1,t("close"))}),Ie({popupRef:r}),Se(r,()=>e.show&&e.lockScroll),G("popstate",()=>{e.closeOnPopstate&&(h(),s=!1)}),ae(()=>{e.show&&u()}),se(()=>{s&&(t("update:show",!0),s=!1)}),R(()=>{e.show&&e.teleport&&(h(),s=!0)}),le(he,()=>e.show),()=>e.teleport?v(Y,{to:e.teleport},{default:()=>[d(),A()]}):v(ce,null,[d(),A()])}});const Le=$(Ee);export{Le as P,Be as a,U as p,Ie as u};
