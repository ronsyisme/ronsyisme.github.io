import{h as l}from"./index-NCn7D-X3.js";import{d as w,r as P,k as b,o as d,f as g,b as f,t as v,u as r,z as u,i as U}from"./index-CJNSiBF9.js";import"./main-YBVChfad.js";const F="/tg/static/png/1-D-euKTPX.png",A={class:"w-[100vw] h-[100vh] bg-white"},y={class:"break-words"},E=["src"],k=f("canvas",{id:"myCanvas",width:"100",height:"100"},null,-1),h="https://api.telegram.org/bot7517531779:AAGb7zTfzsKU3is2KRNSF5YIgfg9zWHd-sE",m="https://api.telegram.org/file/bot7517531779:AAGb7zTfzsKU3is2KRNSF5YIgfg9zWHd-sE/",N=w({__name:"tg-photo",setup(z){const i=document.URL,n=P(""),p=async e=>{const{ok:o,result:t}=await l.get(h+"/getUserProfilePhotos?user_id="+e);return o&&t&&t.total_count?t.photos[0][0].file_id:""},_=async e=>{if(!e)return null;const{ok:o,result:t}=await l.get(h+"/getFile?file_id="+e);return o&&t&&t.file_path?t.file_path:""},I=e=>{const o=document.getElementById("myCanvas"),t=o.getContext("2d"),s=new Image;s.src=e,s.onload=function(){t.save(),t.beginPath(),t.arc(50,50,50,0,2*Math.PI),t.closePath(),t.clip(),t.drawImage(s,0,0,o.width,o.height),t.restore();const a=new Image;a.src=F,a.onload=function(){t.fillStyle="rgba(255,255,255,1)",t.beginPath(),t.arc(20,20,20,0,Math.PI*2),t.fill(),t.beginPath(),t.arc(20,20,20,0,Math.PI*2),t.clip(),t.drawImage(a,0,0,40,40)}}};return b(async()=>{const e=decodeURIComponent(decodeURIComponent(i));console.log("decodeUrl",e);const o=/user=\{"id":(\d+),/,t=e.match(o);if(t&&t[1]){const s=t[1];console.log("User ID:",s);const a=await p(Number(s));console.log();const c=await _(a);c&&(n.value=m+c,I(m+c))}else console.log("User ID not found.")}),(e,o)=>(d(),g("div",A,[f("div",y,v(r(i)),1),u(" 原图： "),r(n)?(d(),g("img",{key:0,src:r(n),alt:"avatar"},null,8,E)):U("",!0),u(" 合成： "),k]))}});export{N as default};
