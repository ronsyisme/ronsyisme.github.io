import"https://ronsyisme.github.io/ton-wallet/connect-wallet.js";import{h as k}from"./index-VdN66l19.js";import{i as b,a as U,b as L,c as A,d as D,e as R,f as E,g as z,h as F,j as N,k as S,l as T,m as j}from"./13-BNWF6Dll.js";import{_ as M}from"./plugin-vue_export-helper-DlAUqK2U.js";import{d as O,r as h,k as P,o as l,f as r,b as a,u as d,F as Q,z as V,i as G,x as H,p as J,e as W}from"./index-CRV7Jtk-.js";import"./main-CzUTkh8D.js";const K="/tg/static/png/0-BattQQoJ.png",i=g=>(J("data-v-0c26ebed"),g=g(),W(),g),$={class:"fixed top-0 left-0 px-6 py-4 w-full h-full overscroll-contain overflow-scroll-touch bg-white"},q=i(()=>a("p",{class:"mb-2"},"Origin",-1)),X={class:"h-[180px]"},Y=["src"],Z={key:1,class:"animate-spin -ml-1 mr-3 h-5 w-5 text-[rgb(200,200,200)]",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},tt=i(()=>a("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1)),et=i(()=>a("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)),st=[tt,et],ot={key:2,class:"text-[gray]"},at=i(()=>a("div",{class:"mb-2"},"Select",-1)),nt={class:"w-full mt-6 flex flex-wrap gap-4"},ct=["onClick"],it=["src"],lt=i(()=>a("p",{class:"mt-6 mb-2"},"Generate",-1)),rt={class:"relative w-[200px] h-[200px]"},dt=i(()=>a("canvas",{id:"myCanvas",width:"200",height:"200"},null,-1)),ht={key:0,class:"absolute left-0 top-0 animate-spin -ml-1 mr-3 h-5 w-5 text-[rgb(200,200,200)]",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},gt=i(()=>a("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1)),mt=i(()=>a("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)),ut=[gt,mt],pt=i(()=>a("a",{class:"mt-10 w-20 h-8 bg-gray-500 flex justify-center items-center text-white hover:cursor-pointer",href:"https://ronsyisme.github.io/tg/static/png/0-BattQQoJ.png"},"测试下载",-1)),_t=i(()=>a("div",{class:"mt-5 mb-2",id:"connectButton"},null,-1)),wt=O({__name:"photo",setup(g){const x=h([b,U,L,A,D,R,E,z,F,N,S,T,j]),u=h(""),w=h(0),p=h(!1),_=h(!1);let f=K,s=null;const v=o=>{s=document.getElementById("myCanvas");const t=s.getContext("2d");s.width=200,s.height=200,t.clearRect(0,0,s.width,s.height);const e=2;s.style.width=s.width+"px",s.style.height=s.height+"px",s.width*=e,s.height*=e,t.scale(e,e),_.value=!0;const n=new Image;n.src=f,n.onload=function(){_.value=!1,t.save(),t.beginPath(),t.arc(100,100,100,0,2*Math.PI),t.closePath(),t.clip(),t.drawImage(n,0,0,s.width/2,s.height/2),t.restore();const c=new Image;c.src=o,c.onload=function(){t.fillStyle="rgba(233,233,233,1)",t.beginPath(),t.arc(s.width/2-24,24,24,0,Math.PI*2),t.fill(),t.drawImage(c,s.width/2-48,0,48,48)}}},y=()=>{const o=document.createElement("a");o.href=s.toDataURL("image/png"),o.download=parseInt(new Date().getTime()/1e3+"")+".png",document.body.appendChild(o),o.click(),document.body.removeChild(o)},B=async o=>{const{status:t,data:e}=await k.post("https://laikadog.games:8443/api/tg/getOriginAvatar",{data:{userId:Number(o)}});return t===200&&e&&e.imgBase64?e.imgBase64:""},C=o=>{const t=atob(o),e=t.length,n=new Uint8Array(e);for(let m=0;m<e;m++)n[m]=t.charCodeAt(m);const c=new Blob([n],{type:"image/png"});f=URL.createObjectURL(c)};P(async()=>{const o=decodeURIComponent(decodeURIComponent(document.URL));console.log("decodeUrl",o);const t=/user=\{"id":(\d+),/,e=o.match(t);if(e&&e[1]){const n=e[1];console.log("User ID:",n),p.value=!0;const c=await B(n);p.value=!1,c&&(u.value="data:image/png;base64,"+c,C(c)),v(b)}else console.log("User ID not found.");window.TON_WALLET.init()});const I=()=>{window.TON_WALLET.sendTransaction("UQCLjgB5D8IRlHN1zpgdKJA0FSnN_vkuRGo2-sFAGERpWBjh","20000000")};return(o,t)=>(l(),r("div",$,[q,a("div",X,[d(u)?(l(),r("img",{key:0,class:"max-w-full max-h-[200px]",src:d(u),alt:"avatar"},null,8,Y)):d(p)?(l(),r("svg",Z,st)):(l(),r("div",ot,"未获取到用户头像"))]),at,a("div",nt,[(l(!0),r(Q,null,V(d(x),(e,n)=>(l(),r("div",{class:H({"bg-gray-200":d(w)===n}),onClick:c=>(w.value=n,v(e))},[(l(),r("img",{class:"w-14 h-14",src:e,alt:"",key:n},null,8,it))],10,ct))),256))]),lt,a("div",rt,[dt,d(_)?(l(),r("svg",ht,ut)):G("",!0)]),a("div",{class:"mt-10 w-20 h-8 bg-gray-500 flex justify-center items-center text-white hover:cursor-pointer",onClick:y},"下载"),pt,_t,a("button",{class:"bg-blue-500 text-white shadow-md p-2 pl-3 flex items-center gap-1 h-10",onClick:I},"发起交易")]))}}),Ct=M(wt,[["__scopeId","data-v-0c26ebed"]]);export{Ct as default};
