import{h as w}from"./index-D_GtYktz.js";import{d as D,r as m,k as x,o as i,f as g,b as c,z as y,u as l,i as k,F as A,A as P,t as E,x as B}from"./index-B0UI-Mgo.js";import"./main-CoKcBc-H.js";const _="/tg/static/png/1-BcTfF4eE.png",R="/tg/static/png/2-B1nvX-Zb.png",z="/tg/static/png/3-vjM5Fdob.png",T="/tg/static/png/4-Dt1rvgdm.png",N="/tg/static/png/5-DThXQQtJ.png",K="/tg/static/png/6-DMVNDDe1.png",L="/tg/static/png/7-k4J8BWCx.png",H="/tg/static/png/8-C4XyiJeW.png",J="/tg/static/png/9-C2TBblwQ.png",M="/tg/static/png/10-DgwZU5IX.png",V="/tg/static/png/11-D2nFwAVK.png",W="/tg/static/png/12-D_maW5Ja.png",G="/tg/static/png/13-zK9PPJH0.png",S={class:"fixed top-0 left-0 px-4 py-4 w-full h-full overscroll-contain overflow-scroll-touch bg-white"},X=["src"],Q=c("div",null,[y(" 合成： "),c("canvas",{id:"myCanvas",width:"200",height:"200"})],-1),j={class:"w-full mt-12 flex flex-wrap gap-4"},Y=["onClick"],Z=["src"],O={class:"break-words mt-8"},v="https://api.telegram.org/bot7517531779:AAGb7zTfzsKU3is2KRNSF5YIgfg9zWHd-sE",I="https://api.telegram.org/file/bot7517531779:AAGb7zTfzsKU3is2KRNSF5YIgfg9zWHd-sE/",nt=D({__name:"tg-photo",setup($){const b=m([_,R,z,T,N,K,L,H,J,M,V,W,G]),p=document.URL,r=m(""),h=m(0);let u="";const C=async o=>{const{ok:t,result:n}=await w.get(v+"/getUserProfilePhotos?user_id="+o);return t&&n&&n.total_count?n.photos[0][0].file_id:""},F=async o=>{if(!o)return null;const{ok:t,result:n}=await w.get(v+"/getFile?file_id="+o);return t&&n&&n.file_path?n.file_path:""};let e=null;const f=o=>{e=document.getElementById("myCanvas");const t=e.getContext("2d");e.width=200,e.height=200,t.clearRect(0,0,e.width,e.height);const n=2;e.style.width=e.width+"px",e.style.height=e.height+"px",e.width*=n,e.height*=n,t.scale(n,n);const s=new Image;s.crossOrigin="Anonymous",s.src=u,s.onload=function(){t.save(),t.beginPath(),t.arc(100,100,100,0,2*Math.PI),t.closePath(),t.clip(),t.drawImage(s,0,0,e.width/2,e.height/2),t.restore();const a=new Image;a.src=o,a.onload=function(){t.fillStyle="rgba(233,233,233,1)",t.beginPath(),t.arc(e.width/2-24,24,24,0,Math.PI*2),t.fill(),t.drawImage(a,e.width/2-48,0,48,48),t.drawImage(a,e.width/2-48,e.height/2-48,48,48)}}},U=()=>{const o=document.createElement("a");o.href=e.toDataURL("image/png"),o.download=parseInt(new Date().getTime()/1e3+"")+".png",document.body.appendChild(o),o.click(),document.body.removeChild(o)};return x(async()=>{const o=decodeURIComponent(decodeURIComponent(p));console.log("decodeUrl",o);const t=/user=\{"id":(\d+),/,n=o.match(t);if(n&&n[1]){const s=n[1];console.log("User ID:",s);const a=await C(Number(s));console.log();const d=await F(a);d&&(r.value=I+d,u=I+d,f(_))}else console.log("User ID not found.")}),(o,t)=>(i(),g("div",S,[c("div",null,[y(" 原图： "),l(r)?(i(),g("img",{key:0,src:l(r),alt:"avatar"},null,8,X)):k("",!0)]),Q,c("div",j,[(i(!0),g(A,null,P(l(b),(n,s)=>(i(),g("div",{class:B({"bg-gray-200":l(h)===s}),onClick:a=>(h.value=s,f(n))},[(i(),g("img",{class:"w-14 h-14",src:n,alt:"",key:s},null,8,Z))],10,Y))),256))]),c("div",{class:"mt-10 w-20 h-8 bg-gray-500 flex justify-center items-center text-white hover:cursor-pointer",onClick:U},"下载"),c("div",O,E(decodeURIComponent(decodeURIComponent(l(p)))),1)]))}});export{nt as default};
