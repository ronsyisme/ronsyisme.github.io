import{h as x}from"./index-bkA_YOq8.js";import{i as y,a as A,b as E,c as B,d as D,e as F,f as L,g as R,h as S,j as H,k as G,l as M,m as N}from"./13-BNWF6Dll.js";import{_ as T}from"./plugin-vue_export-helper-DlAUqK2U.js";import{d as K,r as h,k as V,o as l,f as n,b as a,u as d,F as j,z as W,i as Y,x as O,p as $,e as q}from"./index-B3qiMlEE.js";import"./main-B6sbK3hR.js";const i=g=>($("data-v-16b95537"),g=g(),q(),g),J={class:"fixed top-0 left-0 px-6 py-4 w-full h-full overscroll-contain overflow-scroll-touch bg-white"},Q=i(()=>a("p",{class:"mb-2"},"Origin",-1)),X={class:"h-[180px]"},Z=["src"],tt={key:1,class:"animate-spin -ml-1 mr-3 h-5 w-5 text-[rgb(200,200,200)]",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},et=i(()=>a("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1)),st=i(()=>a("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)),ot=[et,st],at={key:2,class:"text-[gray]"},ct=i(()=>a("div",{class:"mb-2"},"Select",-1)),lt={class:"w-full mt-6 flex flex-wrap gap-4"},nt=["onClick"],it=["src"],rt=i(()=>a("p",{class:"mt-6 mb-2"},"Generate",-1)),dt={class:"relative w-[200px] h-[200px]"},ht=i(()=>a("canvas",{id:"myCanvas",width:"200",height:"200"},null,-1)),gt={key:0,class:"absolute left-0 top-0 animate-spin -ml-1 mr-3 h-5 w-5 text-[rgb(200,200,200)]",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},mt=i(()=>a("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1)),ut=i(()=>a("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)),pt=[mt,ut],I="https://api.telegram.org/bot7517531779:AAGb7zTfzsKU3is2KRNSF5YIgfg9zWHd-sE",b="https://api.telegram.org/file/bot7517531779:AAGb7zTfzsKU3is2KRNSF5YIgfg9zWHd-sE/",_t=K({__name:"tg-photo",setup(g){const k=h([y,A,E,B,D,F,L,R,S,H,G,M,N]),C=document.URL,m=h(""),f=h(0),u=h(!0),p=h(!1);let w="",s=null;const v=o=>{s=document.getElementById("myCanvas");const t=s.getContext("2d");s.width=200,s.height=200,t.clearRect(0,0,s.width,s.height);const e=2;s.style.width=s.width+"px",s.style.height=s.height+"px",s.width*=e,s.height*=e,t.scale(e,e),p.value=!0;const c=new Image;c.src=w,c.onload=function(){p.value=!1,t.save(),t.beginPath(),t.arc(100,100,100,0,2*Math.PI),t.closePath(),t.clip(),t.drawImage(c,0,0,s.width/2,s.height/2),t.restore();const r=new Image;r.src=o,r.onload=function(){t.fillStyle="rgba(233,233,233,1)",t.beginPath(),t.arc(s.width/2-24,24,24,0,Math.PI*2),t.fill(),t.drawImage(r,s.width/2-48,0,48,48)}}},U=()=>{const o=document.createElement("a");o.href=s.toDataURL("image/png"),o.download=parseInt(new Date().getTime()/1e3+"")+".png",document.body.appendChild(o),o.click(),document.body.removeChild(o)},z=async o=>{const{ok:t,result:e}=await x.get(I+"/getUserProfilePhotos?user_id="+o);return t&&e&&e.total_count?e.photos[0][0].file_id:""},P=async o=>{if(!o)return null;const{ok:t,result:e}=await x.get(I+"/getFile?file_id="+o);return t&&e&&e.file_path?e.file_path:""};return V(async()=>{const o=decodeURIComponent(decodeURIComponent(C));console.log("decodeUrl",o);const t=/user=\{"id":(\d+),/,e=o.match(t);if(e&&e[1]){const c=e[1];console.log("User ID:",c);const r=await z(Number(c)),_=await P(r);_?(m.value=b+_,w=b+_,v(y)):u.value=!1}else u.value=!1,console.log("User ID not found.")}),(o,t)=>(l(),n("div",J,[Q,a("div",X,[d(m)?(l(),n("img",{key:0,class:"max-w-full max-h-[200px]",src:d(m),alt:"avatar"},null,8,Z)):d(u)?(l(),n("svg",tt,ot)):(l(),n("div",at,"图片获取失败"))]),ct,a("div",lt,[(l(!0),n(j,null,W(d(k),(e,c)=>(l(),n("div",{class:O({"bg-gray-200":d(f)===c}),onClick:r=>(f.value=c,v(e))},[(l(),n("img",{class:"w-14 h-14",src:e,alt:"",key:c},null,8,it))],10,nt))),256))]),rt,a("div",dt,[ht,d(p)?(l(),n("svg",gt,pt)):Y("",!0)]),a("div",{class:"mt-10 w-20 h-8 bg-gray-500 flex justify-center items-center text-white hover:cursor-pointer",onClick:U},"下载")]))}}),It=T(_t,[["__scopeId","data-v-16b95537"]]);export{It as default};
